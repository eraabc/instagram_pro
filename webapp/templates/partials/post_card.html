<div class="card mb-4 shadow-sm mt-5">
    <div class="card-header bg-white d-flex align-items-center">
        <a class="text-decoration-none text-dark" href="{% url 'accounts:profile' post.author.id %}">
            {% if post.author.avatar %}
            <img src="{{ post.author.avatar.url }}" alt="Avatar" class="rounded-circle me-2"
                 style="width: 40px; height: 40px; object-fit: cover;">
            {% else %}
                <img src="https://www.shutterstock.com/image-vector/profile-picture-user-vector-illustration-600nw-2482138073.jpg" class="rounded-circle me-2" style="width: 40px;height: 40px;object-fit: cover"
                 alt="Avatar">
            {% endif %}
            <strong>{{ post.author.username }}</strong>
        </a>

    </div>

    <a href="{% url 'webapp:detail_post' post.pk %}"><img src="{{ post.image.url }}" class="card-img-top" alt="Post Image"
         style="object-fit: cover; max-height: 500px;"></a>

    <div class="card-body pb-1">
        <div class="mb-2 d-flex align-items-center">
            {% if user.is_authenticated %}
                <form action="{% url 'webapp:like_post' post.pk %}" method="post">
                    {% csrf_token %}
                    <button type="submit" class="btn-like">
                        {% if post.id in liked_posts %}
                            <i class="bi bi-heart me-3 fs-5 text-danger" title="Убрать лайк"></i>
                        {% else %}
                            <i class="bi bi-heart me-3 fs-5" title="Поставить лайк"></i>
                        {% endif %}
                    </button>
                </form>
            {% else %}
                <a href="{% url 'accounts:login' %}"><i class="bi bi-heart me-3 fs-5"></i></a>
            {% endif %}

            <a class="text-dark text-decoration-none" href="{% url 'webapp:detail_post' post.pk %}">
                <strong class="ms-2 me-1">{{ post.comments.count }}</strong>
                <i class="bi bi-chat me-3 fs-5"></i>
            </a>
            {% if post.author == user or perms.webapp.change_post %}
                <a class="text-dark text-decoration-none" href="{% url 'webapp:update_post' post.pk %}">
                    <i class="bi bi-pencil me-3 fs-5" title="Редактировать"></i>
                </a>
            {% endif %}
            {% if post.author == user or perms.webapp.delete_post %}
                <a class="text-dark text-decoration-none" href="{% url 'webapp:delete_post' post.pk %}">
                    <i class="bi bi-trash me-3  fs-5 text-danger" title="Удалить"></i>
                </a>
            {% endif %}
        </div>

        <p class="mb-1"><strong>{{ post.likes.count }}</strong> отметок "Нравится"</p>

        <a class="text-decoration-none text-dark" href="{% url 'accounts:profile' post.author.id %}">
            <p class="mb-0">
                <strong>{{ post.author.username }}</strong> {{ post.description }}
            </p>
        </a>
    </div>
</div>
